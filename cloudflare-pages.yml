version: 1
build:
  command:
    - mkdir -p public
    - echo "Generating worker.js..."
    - echo "addEventListener('fetch', (event) => { event.respondWith(handleRequest(event.request)); });" > public/worker.js
    - echo "async function handleRequest(request) { const dynamicContent = '${DYNAMIC_CONTENT}'; return new Response(dynamicContent, { headers: { 'Content-Type': 'text/plain' } }); }" >> public/worker.js
  routes:
    - '/api/dynamic-content/*'
